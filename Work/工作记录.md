# 日报

密码:w130126F

# 2023年4月27日

> 任务中心新增根据铁民给的数据进行与各种选择控件绑定以及功能控件选择数据逻辑和适配

```
1、动态新增大量小任务部分,由于大量的输入框和下拉框动态生成,需要进行输入软键盘适配和数据输入数据获取。
   动态新增功能模块交互完成.且用户没有输入可提示对应获取输入框焦点。
2、根据昨天给的数据模型进行模拟数据获取设置到对应的控件上面.
   数据模型绑定成功.后期看软名接口对接 **[children]**
3、对于时间选择控件进行昨天讨论进行限制设置以及时间获取等.
   时间选择控件交互和逻辑都已经处理.且增加了提示红色显示,当用户设置完成可再次变黑色。
4、最后保存时候,获取所有当前的控件内容,主要是动态生成列表部分.动态生成取值可能比较复杂。
   通过便利动态帅选ID进行对应UI控件的空判断等进行交互提示用户
5、代码提交到github 私有库
```



# 2023年4月28日

> 根据UI效果图，进行UI效果实现

##### 1、采集页面

# 2023年5月03日

采集信息详情复杂列表界面根据UI效果图以及切图进行开发

```
1、信息采集详情收费站列表模块时间2小时
2、服务区采集列表部分时间大概2小时。
3、桥梁区采集嵌套列表部分时间大概2小时
4、根据数据接口进行UI交互接口的开放。保证后期数据增多可用3小时左右。
```



# 2023年5月04日

采集信息详情复杂列表界面根据UI效果图以及切图进行开发

```
1、信息采集详情收费站列表模块时间2小时
2、服务区采集列表部分时间大概2小时。
3、桥梁区采集嵌套列表部分时间大概2小时
4、根据数据接口进行UI交互接口的开放。保证后期数据增多可用3小时左右。
```

# 2023年5月05日

任务新增界面根据UI进行适配。时间8小时

```
1、任务新增界面根据UI进行适配。
2、UI对横竖屏和手机机型大概进行适配。等后期遇到具体机型进行调试UI
3、对顶部状态栏bar颜色根据Navigation进行动态修改适配不同的页面
4、对于任务新增功能，动态添加任务UI部分进行适配。
5、代码布局优化。
```

# 2023年5月06日

任务首页列表搭建网络请求框架搭建和明哥调通了和服务器的响应。时间8小时。

```
1、首页任块列表的开发。
2、进行网络请求框架的搭建。
3、和明哥调试服务。
4、对单机平板和移动应用的讨论。
5、任块列表接口调试完毕，进行网络请求数据且展示完成。
6、采集列表首页接口调试完毕，对服务数据展示。
```

# 2023年5月08日

主要进行手机尺寸的调试适配

```
1、首页采集模块的兼容手机尺寸模式调试适配。
2、采集详情兼容手机尺寸模式调试适配。
3、首页任务兼容手机尺寸模式调试适配。
4、任务新增模块兼容手机尺寸模式调试适配。
5、代码的优化和逻辑的调整等....
```

# 2023年5月09日

根据设计出图进行首页采集和任务页面调整适配

```
1、根据设计出图进行首页采集和任务页面调整适配
2、任务列表分页功能的编写。
3、实现上啦无限滚动加载。提供数据请求过程加载圈等效果。
```

# 2023年5月10日

接口调试：

根据设计出图进行首页采集和任务页面调整适配

```
1、任务中心详情页面任务类型数据和任务周期接口
2、获取负责人接口编写
```

# 2023年5月11日

根据PC端对添加任务界面进行自定义控件。由于Google官方没有自带的联动多级下啦控件。所以需要大量时间来进行自定义。

```
1、任务新增任务类型需要下拉弹窗，且有多选等操作。对这部分进行自定义，实现用户可以多项选择，对应的任务控件上方有各项选择，且各个都可以点击删除。对应的下拉弹窗内部的数据UI也跟随变动。
2、新增小任务，复杂表单每个点击都需要弹窗人员多级联动选择，这一块也同样自定义。实现下拉多级联动效果。且多个人员表单都不可影响数据。
```

# 2023年5月12日

由于内网原因，大部分情况下，未连接内网都是没法点击查看UI效果的。所以增加假数据，方便使用者了解应用的功能和查看效果。

```
1、由于内网原因，大部分情况下，未连接内网都是没法点击查看UI效果的。所以增加假数据，方便使用者了解应用的功能和查看效果。
2、调试完成任务新增接口。新增成功。
3、用DataStore进行用户设置储存数据访问本地还是网络状态，当用户未连接内网时，可以通过设置中点击进入设置中心界面开启本地数据，然后进行使用。
```

# 2023年5月15日

登陆界面根据设计UI进行界面布局、接口调试、用户名和密码等逻辑交验

```
1、登陆界面布局根据UI设计进行调试。自定义半圆角shape等，根据具体px进行界面编写。1小时
2、登陆界面验证码和明哥一起确认并调试相关验证码接口，搭建登陆部分的服务框架，因为host和端口不一致。用时3小时。
3、登陆接口调试，由于cooke需要验证码和登陆接口一致，一下午基本和明哥在调试中。最终通过cooke发现问题，并解决。登陆接口调试完成。
4、登陆和验证码部分代码逻辑编写。包括网络层，数据层，和交互逻辑层。View交互层。
```

# 2023年5月16日

主要还是解决登陆界面验证码和登陆接口Coocke问题。

```
1、发现cooke不变不管用户名和密码是否一致都会默认登陆成功。主要解决了验证码和登陆接口的cooke问题。
   验证码请求成功->请求过程拦截储存cookes
   验证码请求失败->再次提示验证码过期需要再次请求等
   登陆请求过程->获取本地cookes，如果有cookes在其拦截器设置其cookes、无请求失败
   请求失败根据请求结果进行提示是否再次获取验证码还是登陆密码和用户名错误等逻辑。
2、通过DataStore对用户的登陆数据进行保存，并在用户界面进行显示用户名，在后面接口获取对应的userId。
3、通过登陆userId进行采集列表用户数据请求。
```

工项目网络图片使用。自己图床

![](https://gitee.com/LuHenChang/blog_pic/raw/master/image-20230516202704434.png)

![daolu_example](https://gitee.com/LuHenChang/blog_pic/raw/master/daolu_example.png)

# 2023年5月17日

主要和服务端沟通进行采集信息详情的构建。

```
1、完成了采集线路模块详情的：铁路高地模块、路径收费站模块、路径桥模块、铁路上行立交模块。包括UI适配器，每个模块都代表着一个适配UI容器。
3、通过接口进行组装对应对的数据。
4、针对相关后台提供的文档，进行对应字段说明来展示UI内容等。以及相关逻辑编写。
```

# 2023年5月18日

1、继续采集信息详情的构建。对于不同数据模型进行适配器的搭建和数据和控件的绑定展示等。
2、庞大的适配器代码进行优化，通过扩展函数以及范型注入优化庞杂的多模块适配器。

```
1、铁路站点模块。
2、通道溶洞模块。
3、通道隧道模块。
4、平交道路模块。
5、铁路桥梁模块。
6、通道溶洞模块。
7、通道隧道模块。
8、平交道路信息
9、铁路桥梁信息
10、铁路上行道路
11、路径关键人员采集表
12路径服务区域

```

# 2023年5月19日

1、/acquisition/domicile-brief/appGetDomicileMsg 745
这个是住地的详情 updateDomicileInfo
2、/acquisition/scene-brief-info/appGetSceneMsg 566
现场的详情    addSceneUsingPOST

```
1、铁路站点模块。
2、通道溶洞模块。
3、通道隧道模块。
4、平交道路模块。
5、铁路桥梁模块。
6、通道溶洞模块。
7、通道隧道模块。
8、平交道路信息
9、铁路桥梁信息
10、铁路上行道路
11、路径关键人员采集表
12路径服务区域

```

# 2023年5月22日

1、调试采集页面的条件刷选接口。模糊查询接口。默认全部数据接口。
2、调试采集详情页面，现场和驻地对应的界面和相关的展示数据逻辑。
3、svn配置和后台调试等

```
    /**
     * 2、首页采集列表接口
     * userId 用户ID
     */
    @GET("acquisition/task-person/appGetTpDataTree")
    open fun getTpDataTree(
        @Query("userId") userId: Int,
        @Query("status") status: String,
        @Query("name") name: String
    ): Call<CollectListModel>v
```

# 2023年5月23日

1、调试任务新增的接口
2、进行登陆退出功能的编写。和登陆退出逻辑代码的编写
3、任务详情列表的搭建。通过Tablayout和fragment+viewPager做为框架，进行碎片滑动切换                                          4、逻辑代码的编写

# 2023年5月24日

1、任务详情打分碎片UI框架搭建。
2、任务详情ScoringFragment编写。
3、对于打分输入框进行过滤匹配，避免用户输入错误等问题。

11:12 - 14:30
1、对任务详情界面UI进行fragment适配。
2、对首页采集搜索输入焦点问题进行优化。输入框搜索结束->清除焦点。
3、对网络请求架构进行通过DataRespostory分离。

<img src="https://gitee.com/LuHenChang/blog_pic/raw/master/image-20230524145635031.png" alt="image-20230524145635031" style="zoom:50%;" />

17:30
1、和服务端沟通相关审核打分的逻辑需求
2、对其进行UI和数据分析，进行新页面的跳转逻辑设计编写。
3、进行对其子任务的列表适配器展示和架构。

# 2023年5月25日

1、任务详情打分弹窗的编写。
2、任务详情打分逻辑编写。

```
1、关键的子任务列表展示之后、根据状态来进行操作，有且只有待审核才可以进行打分操作。
2、打分弹窗中进行人工分数、人工比例、自动比例相关的逻辑操作哦。
3、成功之后需要更新当前界面列表等状态和数据等操作逻辑，逻辑编写中....。
```

3、进行审核打分，通过和未通过界面和逻辑的增加。
5、进行打分之后的数据再次请求更新当前界面逻辑。

```
1、目前只是猜想中进行设计界面。需要UI进行新界面的设计。
2、对于打分部分作为弹窗展示。
3、打分成功和失败用有颜色的吐司进行提示。
```

## 2023年5月26日

1、打分类型逻辑的更换。
2、任务部分变动，三级联动。之前二级联动。
3、增加三级人员联动接口和UI调试。

## 2023

一、对审核打分根据需求进行需求流程进行开发。
   1、 主任务点击->子任务->审核打比例分 UI和逻辑流程
   2、 子任务表的展示->通过和未通过->通过与否进行提交后台->展示打分结果。
二、进行跟踪接口和界面的调试开发。
三、其他新需求的开发。

## 2023年5月29日
1、审核打分逻辑
2、审核打分弹窗和跳转流程 
3、审核打分请求封装

## 2023年5月30日

1、任务跟踪逻辑UI的编写
2、采用Google最新的Compose编写
3、任务进度自定义
4、任务信息部分表格展示部分编写



## 2023年6月12日

主要是【现场、住地、路线】采集新增内容。

##### 1、住地部分对一下表进行新增功能。

"住地周边“低慢小”航空器", "住地周边重点人员情况", "住地方位图",
"概要", "警卫安全员、信息员登记表", "住地周边单位情况采集表",
"长包房登记表", "住地平面图", "服务处登记表", "住地周边宗教场所情况采集表",
"住地基本信息", "住地周边要害部位登记表"

##### 2、现场部分对一下表进行新增功能

  “基本信息采集表”........is SceneBasicInfo -> bindSceneBasicInfo(data)
is BriefInfo -> bindBriefInfo(data)
is SceneCriticalPart -> bindSceneCriticalPart(data)
is Ground -> bindGround(data)
is SceneKeyPeople -> bindSceneKeyPeople(data)
is SceneLowSlowSmall -> bindSceneLowSlowSmall(data)
is SceneOrientation -> bindSceneOrientation(data)
is ScenePeripheralUnit -> bindScenePeripheralUnit(data)
is ScenePlan -> bindScenePlan(data)
is Religiou -> bindReligion(data)
is Staff -> bindStaff(data)

##### 3、路线部分对一下表进行新增功能

//1、铁路高地采集表
is RailwayHighGround -> bindRailwayHighGround(data)
//2、路径收费站采集表
is PathTollStation -> bindPathTollStation(data)
//3、路径收费站采集表
is PathBrideg -> bindPathBride(data)
//4、铁路上行立交桥采集表
is RailwayUpInterchange -> bindRailwayUpInterchange(data)
//5、铁路站点信息采集表
is RailwaySite -> bindRailwaySite(data)
//6、通道溶洞
is PathCulvert -> bindPathCulvert(data)
//7、通道隧道
is PathTunnel -> bindPathTunnel(data)
//8、平交道路信息
is RailwayGrade -> bindRailwayGrade(data)
//9、铁路桥梁信息
is RailwayBridge -> bindRailwayBridge(data)
//10、铁路上行道路
is RailwayUpRoad -> bindRailwayUpRoad(data)
//11、路径关键人员采集表
is PathKeyPeople -> bindPathKeyPeople(data)
//12路径服务区域
is PathServiceArea -> bindPathServiceArea(data)

##### 4、实现各个表可以任意无限行增功能和每个单元格编辑功能。

##### 5、实现所有数据可以提交到后台。

##### 6、且可以实现图片上传功能。

##### 7、其他逻辑交互功能等。

 

## 2023年6月19日

##### 主要完成住地、现场、路线相关表单新增的功能

1、住地表单图片新增和数据后台上传部分功能。Plan、ServiceSpace、HighGround

2、住地表单图片新增和数据后台上传部分功能Brief、DomicileReligiou、Guard

3、现场任务表单新增和数据上传服务功能。

4、路线任务表单新增和数据上传服务功能。

## 2023年6月



## 25日

下午：18:00 - 21:20 【6点20左右吃了一趟饭】

# 最终需要解决问题：

### 1、线路数据提交

### 2、现场数据提交

### 3、各个详情展示查看是否有标题。采集详情页面。

### 4、最终提交按钮。



2023年7月3日

1、进行VR视频播放支持支持。前段的播放嵌入到移动端。

2、尝试three.js是否可以在移动端webView支持播放360VR视频。

3、设置页面的编写，进行用户名修改操作。

4、根据测试过程，对已经做完相关模块的完善和更新。相关UI的完善等。

5、代码优化等。









# Bug核对和修复发

一、三、五、六、七、十

##### 一、Tablayout Tab自身不支持过长文字，而是自动测量。根据分辨率和字符长度来进行测量显示的。

定位：控件自身问题，未提供解决接口，不做处理。
>Tablayout Tab文字过长点击自动缩小问题，由于咋们表字段过长，TabLayout文字过长会自动测量，并没有提API去修改。此问题控件自身不支持控制过长文字大小。 
##### 二、登陆->登录 修改完成
##### 三、点击搜索按钮无反应
定位：提示作用，非点击按钮。
处理：将图标移动到前面。

> 此按钮图标是做为提示的，无点击功能，点击搜索按钮在键盘上面。

##### 四、记住密码后直接记忆填入,密码提示为空

定位：对于开启过密保箱功能，填入，做监听，解决提示空问题。
处理：填入数据之后，监听->如果数据有效->去除提示。

##### 五、类型不匹配

定位：应该是公司的后台代码没更新。
处理：等代码更新之后再测。

##### 六、密码无显隐开关

定位：根据目前抖音，快手，圆通。以及目前手机都有密码保护箱功能，不添加此按钮。
处理：不做处理。

##### 七、任务分配为空

定位：子任务非必须项，没有这个需求。
处理：如果需要增加这个必须条件，再进行添加。

##### 八、日期时间显示

定位：时间不不需要精确到时分秒。
处理：对时间时分秒进行去除。

##### 九、删除图标错误

定位：替换好看点的图标
处理：替换图标。

##### 十、提示方式问题

定位：输入框可以通过erro去设置提示。
非输入框用原生常用的snackTost显示提示。
处理：不做处理。

##### 十一、未查询到记录无提示

定位：关数展示做提示
处理：采用常用的snack做提示。

##### **十二、**验证码错误提示验证码过期



# 平板适配

##### 1、SQL语句新建DB

```sql
<!--住地简介照片-->
CREATE TABLE IF NOT EXISTS data_dimage_brief
(
    id integer NOT NULL,
    image_url character varying(255),
    brief_id integer,
    CONSTRAINT data_dimage_brief_pkey PRIMARY KEY (id)
)
<!--住地周边高点照片-->
CREATE TABLE IF NOT EXISTS data_dimage_high
(
    id integer NOT NULL,
    high_id integer,
    image_url character varying(255),
    CONSTRAINT data_dimage_high_pkey PRIMARY KEY (id)
)
<!--住地方位图图片-->
CREATE TABLE IF NOT EXISTS data_dimage_orientation
(
    id integer NOT NULL,
    orientation_id integer,
    image_url character varying(255),
    CONSTRAINT data_dimage_orientation_pkey PRIMARY KEY (id)
)

```

#### 1、后台数据库转为移动端可用sqlite可用数据库。

​       1、将后台数据库转化为移动端可以操作的.db文件
​       2、进行数据库本地加载。
​       3、新建各接口框架。移除网络请求部分等。

#### 2、首页采集页面本地数据库表相关操作。包括：

​       和服务端沟通后台接口查询逻辑
​       1、根据状态查询
​       2、模糊搜索查询等  
​       3、进行分页加载。
​       4、将查询到的数据对应转化为移动端需要Bean。
​       5.且能够展示。

#### 3、首页任务页面本地数据库表相关操作。包括：

​      和服务端沟通后台接口查询逻辑
​      1、根据type_statu查询
​      2、模糊关键字搜索查询
​      3、进行分页加载。
​      4、将查询到的数据对应转化为移动端需要Bean。
​      5、且能够展示。

#### 4、采集详情页面 - 线路类型查询：

​      和服务端沟通后台接口查询逻辑
   路线部分数据查询逻辑和接口。数据转为移动端可展示数据。且展示所有现场详情相关11个表格UI。

#### 5、首页任务页面本地数据库表相关操作。包括：

1、采集详情页面 - 现场类型查询：
      和服务端沟通后台接口查询逻辑
   现场部分数据查询逻辑和接口。数据转为移动端可展示数据。且展示所有现场详情相关13个表格UI。

2、采集详情页面 - 住地类型查询：
      和服务端沟通后台接口查询逻辑
   现场部分数据查询逻辑和接口。数据转为移动端可展示数据。且展示所有住地详情相关12个表格UI。

#### 6、 任务新增页面：

1、任务类型接口db相关查询逻辑转移到移动端。且建立查询，查询分装转化为移动端Bean，展示在移动端。
2、任务周期接口db相关查询逻辑转移到移动端。且建立查询，查询分装转化为移动端Bean，展示在移动端。
3、将任务新增页面的数据进行插入到对应的几张关联表中。且能够展示在采集部分和任务部分。
4、页面部分进行数据Bean转化为相关UI，且可以主动刷新UI等交互功能。

相关界面逻辑和图片部分可以周末加加班完成。

#### 1、任务详情页面

1、详细信息接口逻辑转移到移动端，查询分装且转为移动端Bean，展示在移动端。
2、任务跟踪接口逻辑转移到移动端，查询分装且转为移动端Bean，展示在移动端。
3、审核打分接口逻辑转移到移动端，查询分装且转为移动端Bean，展示在移动端。
4、采集提交接口逻辑转移到移动端，查询分装且转为移动端Bean，展示在移动端。
5、审核打分接口进行打分操作。采集完成提交接口。

##### 2、住地部分表操作

​     将服务端接口逻辑移动到移动端，移动端进行本地数据库操作，对下面住地表新增接口，跟新接口编写，将用户数据进行db储存，且储存完成之后，查询更新到界面展示。
​     住地周边“低慢小”航空器"表 、住地周边重点人员情况"表、住地方位图表、
​    概要表、警卫安全员表

#### 3、住地部分表操作

将服务端接口逻辑移动到移动端，移动端进行本地数据库操作，对住地周边单位情况采集表 、长包房登记表、住地平面图表、信息员登记表进行接口查询和数据分装，解析为移动端可以展示的Bean进行展示等。修改，插入，删除等操作。

#### 4、路线表部分表操作

将服务端接口逻辑移动到移动端，移动端进行本地数据库操作，路线表新增接口，跟新接口编写，将用户数据进行db储存。
//1、铁路高地采集表
RailwayHighGround
//2、路径收费站采集表
PathTollStation
//3、路径收费站采集表
PathBrideg
//4、铁路上行立交桥采集表
RailwayUpInterchange 
//5、铁路站点信息采集表
RailwaySite 
//6、通道溶洞
PathCulvert

#### 5、路线表部分表操作

将服务端接口逻辑移动到移动端，移动端进行本地数据库操作，跟新接口编写，将用户数据进行db储存。
//7、通道隧道
PathTunnel
//8、平交道路信息
RailwayGrade
//9、铁路桥梁信息
RailwayBridge
//10、铁路上行道路
RailwayUpRoad
//11、路径关键人员采集表
PathKeyPeople
//12路径服务区域
PathServiceArea

#### 6、现场表部分表操作

将服务端接口逻辑移动到移动端，移动端进行本地数据库操作，跟新接口编写，将用户数据进行db储存，转化为移动端Bean且更新到UI。
SceneBasicInfo
BriefInfo
SceneCriticalPart
Ground 
SceneKeyPeople

#### 7、现场表部分表操作

将下面现场表的服务端接口逻辑移动到移动端，移动端进行本地数据库操作，跟新接口编写，将用户数据进行db储存，转化为移动端Bean且更新到UI。
SceneLowSlowSmall
SceneOrientation
ScenePeripheralUnit
ScenePlan
Religiou
Staff

​    



























